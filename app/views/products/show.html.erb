<%= render 'shared/breadcrumbs' do %>
  <% if @product.categories.any? %>
    <li class="breadcrumb-item">
      <%= link_to @product.categories.first.name, category_path(@product.categories.first) %>
    </li>
  <% end %>
  <li class="breadcrumb-item active"><%= @product.name %></li>
<% end %>

<div class="row mt-4">
  <div class="col-md-6">
    <% if @product.image.attached? %>
      <%= image_tag @product.image, class: 'img-fluid rounded', alt: @product.name %>
    <% else %>
      <%= image_tag 'https://via.placeholder.com/500x500?text=No+Image', class: 'img-fluid rounded' %>
    <% end %>
  </div>

  <div class="col-md-6">
    <h1><%= @product.name %></h1>

    <div class="badges mb-3">
      <% if @product.on_sale %>
        <span class="badge bg-danger">ON SALE</span>
      <% end %>
      <% if @product.is_new %>
        <span class="badge bg-info">NEW</span>
      <% end %>
    </div>

    <h2 class="text-success mb-4"><%= number_to_currency(@product.current_price) %></h2>

    <p class="lead"><%= @product.description %></p>

    <div class="mb-3">
      <strong>Stock:</strong>
      <% if @product.stock_quantity > 0 %>
        <span class="text-success"><%= @product.stock_quantity %> available</span>
      <% else %>
        <span class="text-danger">Out of stock</span>
      <% end %>
    </div>

    <div class="mb-4">
      <strong>Categories:</strong>
      <%= @product.categories.map { |c| link_to c.name, category_path(c), class: 'badge bg-secondary text-decoration-none' }.join(' ').html_safe %>
    </div>

    <% if @product.stock_quantity > 0 %>
      <%= button_to "Add to Cart", add_to_cart_path(@product), method: :post, class: "btn btn-primary btn-lg" %>
    <% else %>
      <button class="btn btn-secondary btn-lg" disabled>Out of Stock</button>
    <% end %>

    <%= link_to "Back to Products", products_path, class: "btn btn-outline-secondary ms-2" %>
  </div>
</div>