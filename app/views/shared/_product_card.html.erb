<div class="col-lg-3 col-md-4 col-sm-6">
  <div class="product-card">
    <% if product.image.attached? %>
      <%= link_to product_path(product) do %>
        <%= image_tag product.image.variant(:medium), alt: product.name %>
      <% end %>
    <% else %>
      <%
        # Generate different colors for different products
        colors = [
          { bg: 'e3f2fd', text: '1976d2' }, # Blue
          { bg: 'fff3e0', text: 'e65100' }, # Orange
          { bg: 'f3e5f5', text: '7b1fa2' }, # Purple
          { bg: 'e8f5e9', text: '2e7d32' }, # Green
          { bg: 'fce4ec', text: 'c2185b' }, # Pink
          { bg: 'fff9c4', text: 'f57f17' }, # Yellow
          { bg: 'e0f2f1', text: '00695c' }, # Teal
          { bg: 'fbe9e7', text: 'bf360c' }  # Deep Orange
        ]
        color_scheme = colors[product.id % colors.length]
        short_name = product.name.split(' ')[0..2].join('+')
      %>
      <%= link_to product_path(product) do %>
        <%= image_tag "https://placehold.co/300x200/#{color_scheme[:bg]}/#{color_scheme[:text]}?text=#{ERB::Util.url_encode(short_name)}", alt: product.name %>
      <% end %>
    <% end %>

    <div class="badges">
      <% if product.on_sale %>
        <span class="badge bg-danger">ON SALE</span>
      <% end %>
      <% if product.is_new %>
        <span class="badge bg-info">NEW</span>
      <% end %>
    </div>

    <h3><%= link_to product.name, product_path(product) %></h3>
    <p class="price"><%= number_to_currency(product.current_price) %></p>

    <% if product.stock_quantity > 0 %>
      <%= button_to "Add to Cart", add_to_cart_path(product), method: :post, class: "btn btn-primary btn-sm w-100" %>
    <% else %>
      <button class="btn btn-secondary btn-sm w-100" disabled>Out of Stock</button>
    <% end %>
  </div>
</div>